{"title":"The Lamb Shift — An Introduction to Quantum Electrodynamics","markdown":{"yaml":{"title":"The Lamb Shift — An Introduction to Quantum Electrodynamics","author":"Daniel Fischer"},"headingText":"The Lamb Shift: Overview and Plan","containsRefs":false,"markdown":"\n\n\nThis chapter examines the origin and significance of the **Lamb shift**, a small but measurable difference in hydrogen energy levels that could not be explained by the Dirac equation alone. Its discovery in 1947 provided crucial evidence for the necessity of **quantum electrodynamics (QED)** and laid the foundation for precision tests of modern physics.\n\nThe specific goals for this chapter are:\n\n1. Review the **historical background**, focusing on the Lamb–Retherford experiment and the theoretical challenges it posed to relativistic quantum mechanics.\n2. Introduce **Feynman diagrams** as a visual and computational tool in QED, including the rules for interpreting fermion and photon lines, vertices, and conservation laws.\n3. Explain the **physical contributions to the Lamb shift**, including  \n   - the **self-energy** of the bound electron,  \n   - the effect of **vacuum polarization**,  \n   - the correction due to the **finite nuclear size**, and  \n   - the role of **higher-order QED terms**, especially for heavy nuclei.\n4. Discuss how these mechanisms are treated **perturbatively in powers of $\\alpha$** (the fine-structure constant) and how the corrections scale with nuclear charge $Z$.\n5. Summarize the **impact of the Lamb shift** as one of the first successful demonstrations of renormalized QED and its continuing role in high-precision spectroscopy.\n\nBy the end of this chapter, the student should understand the experimental discovery of the Lamb shift, identify the main physical processes that contribute to it, and appreciate its importance as a milestone in the development of quantum electrodynamics.\n\n\n<!---\nFirst run latex to create a number of Feynman diagrams as svg's\n--->\n\n```{python}\n#| echo: false\n# eval: false\nimport subprocess\nimport os\n\n# Determine the null device based on the operating system\nnull_device = \"NUL\" if os.name == \"nt\" else \"/dev/null\"\n\n# Write the LaTeX code to a temporary file\nlatex_code = r\"\"\"\n\\documentclass[tikz, border=2mm]{standalone}\n\\usepackage{tikz-feynman}\n\\tikzfeynmanset{compat=1.1.0}\n\n\\begin{document}\n\n\\feynmandiagram [horizontal=a to b, small] {\n  a [particle=\\(e^-\\)] -- [fermion] b [particle=\\(e^-\\)]\n};\n\n% Panel b) Positron propagator\n\\feynmandiagram [horizontal=c to d, small] {\n  c [particle=\\(e^+\\)] -- [anti fermion] d [particle=\\(e^+\\)]\n};\n\n% Panel c) Photon propagator\n\\feynmandiagram [horizontal=e to f, small] {\n  e [particle=\\(\\gamma\\)] -- [photon] f [particle=\\(\\gamma\\)]\n};\n\n% Panel d) Vertex\n\\feynmandiagram [vertical=g to h, horizontal=i to g, small] {\n  i [particle=\\(e^-\\)] -- [fermion] g -- [fermion] h [particle=\\(e^-\\)],\n  g -- [photon] j [particle=\\(\\gamma\\)]\n};\n\n% Panel e) Compton scattering\n\\feynmandiagram [horizontal=a to b, small] {\n  i1 [particle=\\(e^-\\)] -- [fermion] a -- [photon] i2 [particle=\\(\\gamma\\)],\n  a -- [fermion] b,\n  f1 [particle=\\(e^-\\)] -- [anti fermion] b -- [photon] f2 [particle=\\(\\gamma\\)]\n};\n\n% Panel f) Electron-positron annihilation\n\\feynmandiagram [vertical=a to b, small] {\n  i1 [particle=\\(e^+\\)] -- [anti fermion] a -- [photon] i2 [particle=\\(\\gamma\\)],\n  a -- [anti fermion] b,\n  f1 [particle=\\(e^-\\)] -- [fermion] b -- [photon] f2 [particle=\\(\\gamma\\)]\n};\n\n\\tikzset{\n  double fermion/.style={\n    double distance=1pt,\n    postaction={decorate},\n    decoration={markings,mark=at position 0.45 with {\\arrow{>}}}\n  }\n}\n\n\\begin{tikzpicture}\n  % bound electron line (double fermion)\n  \\coordinate (a) at (0,0);\n  \\coordinate (b) at (3,0);\n  \\draw[double fermion] (a) -- (b);\n\n  % labels\n  \\node[left] at (a) {$e^-$};\n  \\node[right] at (b) {$e^-$};\n\n  % photon loop (self-energy)\n  \\draw[decorate, decoration=snake] (0.75,0) arc [start angle=180, end angle=0, radius=0.75cm];\n\n\\end{tikzpicture}\n\n\n\\begin{tikzpicture}\n  % bound electron line\n  \\coordinate (a) at (0,-.50);\n  \\coordinate (b) at (3,-.50);\n  \\draw[double fermion] (a) -- (b);\n  \\node[left] at (a) {$e^-$};\n  \\node[right] at (b) {$e^-$};\n\n\n  % Coulomb photon with vacuum polarization bubble\n  \\draw[decorate, decoration=snake] (1.5,-.5) -- (1.5,0.2);\n\n  % fermion loop (vacuum polarization bubble)\n  \\draw (1.5,0.6) circle (0.4);\n  \\draw (1.5,0.6) circle (0.35);\n  \\draw[->] (1.1,0.6) arc (180:90:0.4);\n  \\draw[->] (1.9,0.6) arc (0:-90:0.4);\n\n\\end{tikzpicture}\n\n\\begin{tikzpicture}\n  % bound electron line (double fermion)\n  \\coordinate (a) at (0,0);\n  \\coordinate (b) at (3,0);\n  \\draw[double fermion] (a) -- (b);\n\n  % labels\n  \\node[left] at (a) {$e^-$};\n  \\node[right] at (b) {$e^-$};\n\n  % photon loop (self-energy)\n  \\draw[decorate, decoration=snake] (0.65,0) arc [start angle=180, end angle=0, radius=0.6cm];\n  \\draw[decorate, decoration=snake] (2.65,0) arc [start angle=0, end angle=-180, radius=0.6cm];\n\n\\end{tikzpicture}\n\n\\begin{tikzpicture}\n  % bound electron line\n  \\coordinate (a) at (0,-.20);\n  \\coordinate (b) at (3,-.20);\n  \\draw[double fermion] (a) -- (b);\n  \\node[left] at (a) {$e^-$};\n  \\node[right] at (b) {$e^-$};\n\n\n  % Coulomb photon with vacuum polarization bubble\n  \\draw[decorate, decoration=snake] (1.5,-.2) -- (1.5,0.2);\n\n  % fermion loop (vacuum polarization bubble)\n  \\draw (1.5,0.6) circle (0.4);\n  \\draw (1.5,0.6) circle (0.35);\n  \\draw[->] (1.1,0.6) arc (180:90:0.4);\n  \\draw[->] (1.9,0.6) arc (0:-90:0.4);\n\n  \\draw[decorate, decoration=snake] (2.1,-.2) arc [start angle=0, end angle=-180, radius=0.6cm];\n\n\\end{tikzpicture}\n\n\\end{document}\n\"\"\"\n\nwith open(\"diagrams.tex\", \"w\") as f:\n    f.write(latex_code)\n\nimport re\n\ndef scale_svg(file_path, factor):\n    \"\"\"\n    Reads an SVG file and scales its width and height attributes.\n    \"\"\"\n    with open(file_path, 'r') as f:\n        content = f.read()\n    \n    # Define a function to perform the scaling on matched values\n    def scale_match(match):\n        value = float(match.group(2)) # Fix: changed from group(1) to group(2)\n        new_value = value * factor\n        return f'{match.group(1)}=\"{new_value:.3f}{match.group(3)}\"'\n        \n    # Regex to find width=\"[number]pt\" and height=\"[number]pt\"\n    # and replace them with the scaled value\n    scaled_content = re.sub(r'(width|height)=\"([\\d.]+)(pt|px)?\"', scale_match, content)\n\n    with open(file_path, 'w') as f:\n        f.write(scaled_content)\n\n# Define the list of diagram names\ndiagram_names = [\"electron\", \"positron\", \"photon\", \"vertex\", \"compton\", \"annihil\", \"SE\", \"VP\", \"SSEE\", \"SVPE\" ]\n\n# Run the commands, redirecting all output to the null device\nwith open(os.devnull, 'w') as FNULL:\n    # Compile the LaTeX file to PDF\n    subprocess.run([\"lualatex\", \"-interaction=nonstopmode\", \"diagrams.tex\"], stdout=FNULL, stderr=FNULL)\n\n    # Convert the PDF pages to SVG\n    # Use a loop to process each diagram\n    for i, name in enumerate(diagram_names):\n        page_number = i + 1\n        output_svg = f\"{name}.svg\"\n        \n        # Convert the PDF page to a specific SVG file\n        subprocess.run([\"pdf2svg\", \"diagrams.pdf\", output_svg, str(page_number)], stdout=FNULL, stderr=FNULL)        \n        # Scale the newly created SVG file\n        scale_svg(output_svg, 2)\n\n    # Clean up temporary files\n    subprocess.run([\"rm\", \"diagrams.tex\", \"diagrams.pdf\", \"diagrams.log\", \"diagram.aux\"], stdout=FNULL, stderr=FNULL)\n```\n\n\n\n\n# 1. Historical Background\n\n## 1.1 The Lamb–Retherford Experiment\n\nIn 1947, **Willis Lamb** and **Robert Retherford** carried out a groundbreaking experiment at Columbia University that revealed a subtle but profound flaw in the then-current understanding of atomic structure.  \n\nAccording to the **Dirac equation**, the states $2S_{1/2}$ and $2P_{1/2}$ of the hydrogen atom should be **exactly degenerate**—that is, they should have the same energy. This prediction was an improvement over the **Schrödinger theory**, which did not account for spin or relativistic effects. Yet when Lamb and Retherford used microwave spectroscopy to measure transitions between these states, they found a tiny but unmistakable **energy difference of about 1058 MHz**.  \n\nThis unexpected result, now known as the **Lamb shift**, demonstrated that neither Schrödinger’s nor Dirac’s framework was the full story. Both theories still treated the electromagnetic field **classically**, neglecting the fact that the field itself must also be quantized.\n\n::: callout-note\n## The Lamb–Retherford Experiment (1947)\n- **Setup**: Microwave spectroscopy of hydrogen atoms.  \n- **Expectation (Dirac theory)**: $2S_{1/2}$ and $2P_{1/2}$ states should be degenerate (same energy).  \n- **Result**: An observed frequency shift of **1058 MHz** (about $4.4 \\,\\mu$eV).  \n- **Conclusion**: A new effect beyond Dirac’s equation — now called the **Lamb shift**.  \n:::\n\n### Experimental Setup\n\nThe experimental arrangement designed by Willis Lamb and Robert Retherford in the late 1940s was carefully constructed to probe the fine details of hydrogen’s energy levels. \n\n```{python}\n#| echo: false\n#| fig-format: png\n#| fig-align: center\n#| fig-alt: The Lamb–Retherford Experiment (1947).\nimport matplotlib.pyplot as plt\nimport matplotlib.patches as patches\nimport matplotlib.lines as mlines\nimport random\nimport numpy as np\n\n# Set up the figure and axes\nfig, ax = plt.subplots(figsize=(8, 4.5))\nax.set_xlim(0, 800)\nax.set_ylim(0, 450)\nax.invert_yaxis()  # Invert y-axis to match SVG's top-down coordinate system\nax.set_aspect('equal', adjustable='box') # Ensure correct aspect ratio\n\n# Hide axes, ticks, and spines\nax.set_axis_off()\n\n# Set up styles (equivalent to SVG CSS classes)\nfont_props_bold = {'fontfamily': 'sans-serif', 'fontsize': 10}\nfont_props_title = {'fontfamily': 'Arial', 'fontweight': 'bold', 'fontsize': 18}\nfont_props_subtitle = {'fontfamily': 'Arial', 'fontstyle': 'italic', 'fontsize': 14}\nfont_props_small = {'fontfamily': 'sans-serif', 'fontstyle': 'italic', 'fontsize': 8}\n\n# 1. OVEN\noven = patches.Rectangle((50, 150), 80, 100, linewidth=2, edgecolor='black', facecolor='#CCCCCC')\nax.add_patch(oven)\n\n# H atoms dots in oven\nrandom.seed(42)  # For reproducible randomness\nnum_atoms = 80\nx_atoms = [random.uniform(55, 125) for _ in range(num_atoms)]\ny_atoms = [random.uniform(155, 245) for _ in range(num_atoms)]\nax.scatter(x_atoms, y_atoms, s=2, color='black') # s=8 is a good visual equivalent for r=1.5\nax.text(90, 270, 'Oven', ha='center', va='center',  **font_props_bold)\n\n# 2. H ATOMS BEAM\nax.plot([130, 700], [200, 200], color='black', linewidth=3, solid_capstyle='butt')\nax.annotate('', xy=(700, 200), xytext=(690, 200), arrowprops=dict(facecolor='black', shrink=0.05, width=2, headwidth=8))\nax.text(175, 185, 'H atoms', ha='center', va='center', **font_props_bold)\nax.text(175, 220, r'1 $S_{1/2}$', ha='center', va='center', **font_props_bold)\n\n\n## **Electron Source & Excitation**\n# 3. ELECTRON SOURCE\nfilament_y = 350\nx_filament = [254, 259, 266, 273, 280, 285]\ny_filament = [filament_y, filament_y + 5, filament_y - 5, filament_y + 5, filament_y - 5, filament_y]\nax.plot(x_filament, y_filament, color='red', linewidth=3)\nax.plot([254, 254], [filament_y, filament_y + 10], color='black', linewidth=1)\nax.plot([285, 285], [filament_y, filament_y + 10], color='black', linewidth=1)\n\n# Electron beam\n#v_arrow_head = patches.FancyArrowPatch((0, 0), (0, 0), arrowstyle='-|>', mutation_scale=10, fc='blue')\nfor i in range(8):\n    start_x = 270 + random.uniform(-1, 1)\n    end_x = 270 + random.gauss(0, 6)\n#    ax.annotate('', xy=(end_x, 90), xytext=(start_x, 330), \n#                 arrowprops=dict(facecolor='blue', shrink=0.05, width=0.5, headwidth=4))\n    plt.arrow(\n        x=270 + random.uniform(-1, 1),\n        y=330,\n        dx=random.gauss(0, 6),\n        dy=-240,\n        width=0.2, # Controls the stem width\n        head_width=5,\n        head_length=15,\n        color='blue',\n        length_includes_head=True\n    )\n\n\n\n# Electron source labels\nax.text(270, 385, 'Electron', ha='center', va='center', **font_props_bold)\nax.text(270, 400, 'source', ha='center', va='center', **font_props_bold)\nax.text(270, 415, '(heated filament)', ha='center', va='center', **font_props_small)\n\n# 4. METASTABLE STATE LABELS\nax.text(400, 185, 'H atoms', ha='center', va='center', **font_props_bold)\nax.text(400, 220, r'2 $S_{1/2}$', ha='center', va='center', **font_props_bold)\n\n\n## **Resonator & Detection**\n# 5. RESONATOR\nresonator = patches.Rectangle((480, 120), 110, 160, linewidth=2, edgecolor='black', facecolor='#E6F3FF', alpha=0.5)\nax.add_patch(resonator)\nfor i in range(12):\n    x = 490 + i*8\n    ax.plot([x, x], [130, 270], color='black', linewidth=1, alpha=0.7)\nax.text(540, 300, 'Resonator', ha='center', va='center', **font_props_bold)\n#ax.text(540, 315, 'tunable', ha='center', va='center', **font_props_bold)\nax.text(540, 330, '1 ... 10 GHz', ha='center', va='center', **font_props_bold)\n\n# 7. TUNGSTEN FOIL DETECTOR\nax.plot([700, 720], [160, 240], color='black', linewidth=3)\nax.text(710, 140, 'W foil', ha='center', va='center', **font_props_bold)\n\n# 8. DETECTION CIRCUIT\nax.text(670, 230, r'$e^{-}$', ha='center', va='center', **font_props_bold)\n#ax.annotate('', xy=(680, 240), xytext=(710, 203), \n#             arrowprops=dict(facecolor='blue', shrink=0.05, width=1.5, headwidth=4))\nax.plot([660, 696], [245, 245], color='black', linewidth=2)\n\nplt.arrow(\n    x=710,\n    y=203,\n    dx=-30,\n    dy=37,\n    width=0.5, # Controls the stem width\n    head_width=9,\n    head_length=9,\n    color='blue',\n    length_includes_head=True\n)\n\n# Wires\nax.plot([678, 678], [245, 280], color='black', linewidth=1)\nax.plot([678, 710], [280, 280], color='black', linewidth=1)\nax.plot([750, 780], [280, 280], color='black', linewidth=1)\nax.plot([710, 780], [200, 200], color='black', linewidth=1)\nax.plot([780, 780], [200, 320], color='black', linewidth=1)\n\n# Ammeter\nammeter = patches.Circle((730, 280), radius=20, edgecolor='black', facecolor='white', linewidth=2)\nax.add_patch(ammeter)\nax.text(730, 280, 'A', ha='center', va='center', fontweight='bold', fontsize=14)\n\n# Ground symbol\nax.plot([765, 795], [320, 320], color='black', linewidth=1)\nax.plot([770, 790], [325, 325], color='black', linewidth=1)\nax.plot([775, 785], [330, 330], color='black', linewidth=1)\n\n# Save the figure\nplt.show()\n\n```\n\nThe apparatus can be understood in several stages:\n\n1. **Oven and hydrogen beam formation.**  \n   In the oven, molecular hydrogen gas is dissociated into atomic hydrogen. A small opening allows a **collimated beam of hydrogen atoms** to emerge. Most atoms in the beam are in the **ground state** ($1S_{1/2}$).\n\n2. **Electron source and collisional excitation.**  \n   The atomic beam passes through a region where it is intersected by a beam of electrons, produced by a heated filament. Collisions between the electrons and hydrogen atoms transfer energy and excite a fraction of the atoms into higher states.  \n   Importantly, a significant number of atoms are promoted into the **metastable $2S_{1/2}$ state**. This state is long-lived because electric-dipole transitions to the ground state are forbidden by selection rules.\n\n3. **Microwave resonator.**  \n   The hydrogen beam then enters a **tunable microwave cavity resonator**, typically in the frequency range of **1–10 GHz**. Inside the resonator, the $2S_{1/2}$ atoms can absorb microwave photons. If the applied frequency corresponds to the energy difference between nearby levels, the atoms are stimulated to make transitions into short-lived states (such as $2P_{1/2}$).\n\n4. **Detection region.**  \n   At the end of the beam line, the hydrogen atoms encounter a thin **tungsten foil**. Ground-state atoms ($1S_{1/2}$) pass through the foil without significant interaction, but atoms in excited states are quenched upon contact, leading to the emission of electrons.  \n\n   These electrons are collected and amplified in a simple **circuit with an ammeter**, allowing the experimenters to monitor the number of atoms in the metastable state as a function of the resonator frequency.\n\nIn summary, the setup combines a **source of atomic hydrogen**, **excitation to a metastable state**, a **microwave cavity for inducing transitions**, and a **detector sensitive to de-excitation processes**. This arrangement enables a very sensitive probe of small energy differences between atomic states.\n\n\n\n---\n\n## 1.2 Theoretical Challenges\n\nPhysicists quickly realized that explaining the Lamb shift required a fully **quantum field theoretical** treatment, where the electron interacts with a quantized electromagnetic field. However, when theorists attempted such calculations, they encountered serious problems: the integrals describing electron–photon interactions diverged to infinity.  \n\nThis was alarming—if taken at face value, it would mean that quantum electrodynamics (QED) produced nonsensical, infinite predictions. A new conceptual framework was needed.\n\n---\n\n## 1.3 Renormalization and the Birth of QED\n\nThe breakthrough came through the work of several theorists, including **Hans Bethe, Julian Schwinger, Richard Feynman, Sin-Itiro Tomonaga,** and later **Freeman Dyson**, who clarified and unified the emerging ideas.  \n\n- **Hans Bethe (1947)** provided the first non-relativistic calculation of the Lamb shift shortly after Lamb’s experimental result. Remarkably, Bethe managed to extract a finite correction by introducing a **cutoff** and subtracting infinities in a physically meaningful way.  \n- **Julian Schwinger, Richard Feynman,** and **Sin-Itiro Tomonaga** independently developed consistent and mathematically rigorous formulations of QED in the late 1940s.  \n- **Freeman Dyson** showed the equivalence of these approaches and placed them in the framework of **renormalization theory**, where infinities could be systematically absorbed into redefined (\"renormalized\") quantities like the electron’s charge and mass.  \n\nThis renormalization procedure transformed QED from a seemingly hopeless theory into one of the most accurate and predictive frameworks in all of physics.\n\n---\n\n## 1.4 Legacy\n\nThe successful explanation of the Lamb shift was a decisive victory for quantum field theory and marked the **birth of modern QED**. Since then, QED has become the most precisely tested theory in science: its predictions, such as the anomalous magnetic moment of the electron, have been confirmed to extraordinary accuracy (better than one part in $10^{12}$).  \n\nThe Lamb shift thus stands not only as an experimental milestone but also as the historical bridge between early quantum mechanics and the modern quantum field theories that underpin our current understanding of fundamental physics.\n\n\n# 2. Feynman diagrams — picturing QED processes\n\nFeynman diagrams are a graphical shorthand used in quantum electrodynamics (QED) and other quantum field theories to represent terms in the perturbative expansion of interaction amplitudes. They serve as visual mnemonics: lines correspond to particles propagating through spacetime, and vertices represent interactions where particles meet and exchange energy or momentum.  \n\n\n\n## 2.1 Basic elements\n\n- **Electron (fermion) propagator**:  \n  A straight line with an arrow pointing **forward in time** (usually drawn upward or left-to-right) represents an electron moving through spacetime.\n\n![](electron.svg){fig-alt=\"Feynman diagram of a free electron.\" fig-align=\"center\" width=30%}\n\n- **Positron (antifermion) propagator**:  \n  A straight line with an arrow pointing **opposite to the time direction** represents the electron’s antiparticle, the positron.  \n\n  :::{.callout-note}\n  ## Why opposite arrows?  \n  This is a consequence of **CPT invariance**: charge conjugation (C), parity inversion (P), and time reversal (T) symmetry together mean that a positron moving forward in time can be equivalently viewed as an electron moving backward in time.  \n  :::  \n\n![](positron.svg){fig-alt=\"Feynman diagram of a free positron.\" fig-align=\"center\" width=30%}\n\n- **Photon propagator**:  \n  A wavy line represents the photon, the mediator of the electromagnetic interaction. Photons are massless and always move at the speed of light.  \n\n![](photon.svg){fig-alt=\"Feynman diagram of a photon.\" fig-align=\"center\" width=30%}\n\n- **Interaction vertex**:  \n  A point where one photon line meets two fermion lines. This encodes the **electromagnetic coupling** (mathematically written as $-ie\\gamma^\\mu$). At each vertex:  \n  - **Charge conservation** always holds: the electron keeps its charge $(-e)$, or an electron–positron pair may annihilate into a photon.  \n  - **Momentum conservation** also always holds.  \n  - **Energy conservation** is respected *globally*, but at very short timescales, “energy borrowing” is possible due to the uncertainty principle ($\\Delta E \\, \\Delta t \\gtrsim \\hbar$). These transient violations are what allow *virtual photons* to exist inside Feynman diagrams.  \n\n![](vertex.svg){fig-alt=\"A vertex in a Feynman diagram.\" fig-align=\"center\" width=30%}\n\n\n\n---\n\n## 2.2 Examples\n\nFeynman diagrams are not just abstract symbols — they represent real processes that can be measured:\n\n- **Compton scattering** (electron–photon scattering):  \n  An electron absorbs a photon and re-emits another photon, changing its direction.  \n\n![](compton.svg){fig-alt=\"The Feynman diagram of Compton scattering.\" fig-align=\"center\" width=30%}\n\n\n- **Electron–positron annihilation**:  \n  An electron and positron annihilate, producing two photons (to conserve momentum).  \n\n![](annihil.svg){fig-alt=\"The Feynman diagram of electron-positron annihilation.\" fig-align=\"center\" width=30%}\n\n\n# 3. Physical origins of the Lamb shift\n\nThe Lamb shift arises from subtle quantum effects beyond the Dirac equation. These effects require the framework of quantum electrodynamics (QED), where both matter and the electromagnetic field are quantized. Several physical mechanisms contribute:\n\n## 3.1 Electron self-energy\nThe electron is not a point particle moving through empty space — it constantly interacts with its own electromagnetic field. In QED, this appears as the electron emitting and then reabsorbing a **virtual photon**.  \n\nThis process alters the effective mass and binding energy of the electron, leading to small shifts in the energy levels. The effect is stronger for states where the electron wavefunction has significant probability density near the nucleus, such as the $2s_{1/2}$ state in hydrogen.  \n\n::: {.note}\n**Feynman diagram:**  \nSelf-energy of a bound electron is represented by a **double line** (electron in a bound state) with a photon loop attached.  \n\n![](SE.svg){fig-alt=\"Self energy Feynman diagram.\" fig-align=\"center\" width=30%}\n:::\n\n\n---\n\n## 3.2 Vacuum polarization\nThe vacuum in QED is not empty: quantum fluctuations continually create and annihilate **virtual electron–positron pairs**. A real or virtual photon propagating through the vacuum can briefly convert into such a pair before recombining.  \n\nThis changes the effective photon propagator, which in turn modifies the Coulomb potential between the nucleus and electron. The result is a slight *screening* of the nuclear charge, which again shifts atomic energy levels.  \n\n::: {.note}\n**Feynman diagram:**  \nVacuum polarization is represented by a photon line that develops a closed electron–positron loop. For bound states, the photon is attached to the double line of the bound electron.  \n\n![](VP.svg){fig-alt=\"Vacuum polarization Feynman diagram.\" fig-align=\"center\" width=30%}\n:::\n\n---\n\n## 3.3 Finite nuclear size\nSo far, we have treated the nucleus as a pointlike particle producing a Coulomb potential. In reality, nuclei have a finite spatial extension, with a charge distribution that smears out the potential at very short distances.  \n\nFor $s$-states, whose wavefunctions penetrate the nucleus, this modification alters the energy levels. While not a QED effect, it is always included in Lamb shift analyses, particularly for heavy nuclei.\n\n---\n\n## 3.4 Higher-order QED contributions\nThe Feynman diagrams discussed so far represent the leading-order QED corrections (lowest powers of the fine-structure constant $\\alpha$). In practice, higher-order diagrams — involving multiple photon exchanges, loops, or vertex corrections — also contribute.  \n\n![](SSEE.svg){fig-alt=\"Second order self energy Feynman diagram.\" fig-align=\"center\" width=30%}\n![](SVPE.svg){fig-alt=\"Second order self energy with vacuum polarization Feynman diagram.\" fig-align=\"center\" width=30%}\n\nThese are systematically included using **perturbation theory**. The expansion parameter is $\\alpha Z$, where $\\alpha \\approx 1/137$ is the fine-structure constant and $Z$ is the nuclear charge. For light atoms like hydrogen, higher-order terms are tiny, but for heavier nuclei (large $Z$) they become increasingly important.  \n\n\n\n\n---\n\n## Summary\nThe Lamb shift is not the result of a single effect, but rather the interplay of self-energy, vacuum polarization, nuclear size corrections, and higher-order QED processes. Its accurate theoretical calculation required the development of renormalized QED — one of the most successful and precise theories in physics.\n\n\n\n\n","srcMarkdownNoYaml":"\n\n# The Lamb Shift: Overview and Plan\n\nThis chapter examines the origin and significance of the **Lamb shift**, a small but measurable difference in hydrogen energy levels that could not be explained by the Dirac equation alone. Its discovery in 1947 provided crucial evidence for the necessity of **quantum electrodynamics (QED)** and laid the foundation for precision tests of modern physics.\n\nThe specific goals for this chapter are:\n\n1. Review the **historical background**, focusing on the Lamb–Retherford experiment and the theoretical challenges it posed to relativistic quantum mechanics.\n2. Introduce **Feynman diagrams** as a visual and computational tool in QED, including the rules for interpreting fermion and photon lines, vertices, and conservation laws.\n3. Explain the **physical contributions to the Lamb shift**, including  \n   - the **self-energy** of the bound electron,  \n   - the effect of **vacuum polarization**,  \n   - the correction due to the **finite nuclear size**, and  \n   - the role of **higher-order QED terms**, especially for heavy nuclei.\n4. Discuss how these mechanisms are treated **perturbatively in powers of $\\alpha$** (the fine-structure constant) and how the corrections scale with nuclear charge $Z$.\n5. Summarize the **impact of the Lamb shift** as one of the first successful demonstrations of renormalized QED and its continuing role in high-precision spectroscopy.\n\nBy the end of this chapter, the student should understand the experimental discovery of the Lamb shift, identify the main physical processes that contribute to it, and appreciate its importance as a milestone in the development of quantum electrodynamics.\n\n\n<!---\nFirst run latex to create a number of Feynman diagrams as svg's\n--->\n\n```{python}\n#| echo: false\n# eval: false\nimport subprocess\nimport os\n\n# Determine the null device based on the operating system\nnull_device = \"NUL\" if os.name == \"nt\" else \"/dev/null\"\n\n# Write the LaTeX code to a temporary file\nlatex_code = r\"\"\"\n\\documentclass[tikz, border=2mm]{standalone}\n\\usepackage{tikz-feynman}\n\\tikzfeynmanset{compat=1.1.0}\n\n\\begin{document}\n\n\\feynmandiagram [horizontal=a to b, small] {\n  a [particle=\\(e^-\\)] -- [fermion] b [particle=\\(e^-\\)]\n};\n\n% Panel b) Positron propagator\n\\feynmandiagram [horizontal=c to d, small] {\n  c [particle=\\(e^+\\)] -- [anti fermion] d [particle=\\(e^+\\)]\n};\n\n% Panel c) Photon propagator\n\\feynmandiagram [horizontal=e to f, small] {\n  e [particle=\\(\\gamma\\)] -- [photon] f [particle=\\(\\gamma\\)]\n};\n\n% Panel d) Vertex\n\\feynmandiagram [vertical=g to h, horizontal=i to g, small] {\n  i [particle=\\(e^-\\)] -- [fermion] g -- [fermion] h [particle=\\(e^-\\)],\n  g -- [photon] j [particle=\\(\\gamma\\)]\n};\n\n% Panel e) Compton scattering\n\\feynmandiagram [horizontal=a to b, small] {\n  i1 [particle=\\(e^-\\)] -- [fermion] a -- [photon] i2 [particle=\\(\\gamma\\)],\n  a -- [fermion] b,\n  f1 [particle=\\(e^-\\)] -- [anti fermion] b -- [photon] f2 [particle=\\(\\gamma\\)]\n};\n\n% Panel f) Electron-positron annihilation\n\\feynmandiagram [vertical=a to b, small] {\n  i1 [particle=\\(e^+\\)] -- [anti fermion] a -- [photon] i2 [particle=\\(\\gamma\\)],\n  a -- [anti fermion] b,\n  f1 [particle=\\(e^-\\)] -- [fermion] b -- [photon] f2 [particle=\\(\\gamma\\)]\n};\n\n\\tikzset{\n  double fermion/.style={\n    double distance=1pt,\n    postaction={decorate},\n    decoration={markings,mark=at position 0.45 with {\\arrow{>}}}\n  }\n}\n\n\\begin{tikzpicture}\n  % bound electron line (double fermion)\n  \\coordinate (a) at (0,0);\n  \\coordinate (b) at (3,0);\n  \\draw[double fermion] (a) -- (b);\n\n  % labels\n  \\node[left] at (a) {$e^-$};\n  \\node[right] at (b) {$e^-$};\n\n  % photon loop (self-energy)\n  \\draw[decorate, decoration=snake] (0.75,0) arc [start angle=180, end angle=0, radius=0.75cm];\n\n\\end{tikzpicture}\n\n\n\\begin{tikzpicture}\n  % bound electron line\n  \\coordinate (a) at (0,-.50);\n  \\coordinate (b) at (3,-.50);\n  \\draw[double fermion] (a) -- (b);\n  \\node[left] at (a) {$e^-$};\n  \\node[right] at (b) {$e^-$};\n\n\n  % Coulomb photon with vacuum polarization bubble\n  \\draw[decorate, decoration=snake] (1.5,-.5) -- (1.5,0.2);\n\n  % fermion loop (vacuum polarization bubble)\n  \\draw (1.5,0.6) circle (0.4);\n  \\draw (1.5,0.6) circle (0.35);\n  \\draw[->] (1.1,0.6) arc (180:90:0.4);\n  \\draw[->] (1.9,0.6) arc (0:-90:0.4);\n\n\\end{tikzpicture}\n\n\\begin{tikzpicture}\n  % bound electron line (double fermion)\n  \\coordinate (a) at (0,0);\n  \\coordinate (b) at (3,0);\n  \\draw[double fermion] (a) -- (b);\n\n  % labels\n  \\node[left] at (a) {$e^-$};\n  \\node[right] at (b) {$e^-$};\n\n  % photon loop (self-energy)\n  \\draw[decorate, decoration=snake] (0.65,0) arc [start angle=180, end angle=0, radius=0.6cm];\n  \\draw[decorate, decoration=snake] (2.65,0) arc [start angle=0, end angle=-180, radius=0.6cm];\n\n\\end{tikzpicture}\n\n\\begin{tikzpicture}\n  % bound electron line\n  \\coordinate (a) at (0,-.20);\n  \\coordinate (b) at (3,-.20);\n  \\draw[double fermion] (a) -- (b);\n  \\node[left] at (a) {$e^-$};\n  \\node[right] at (b) {$e^-$};\n\n\n  % Coulomb photon with vacuum polarization bubble\n  \\draw[decorate, decoration=snake] (1.5,-.2) -- (1.5,0.2);\n\n  % fermion loop (vacuum polarization bubble)\n  \\draw (1.5,0.6) circle (0.4);\n  \\draw (1.5,0.6) circle (0.35);\n  \\draw[->] (1.1,0.6) arc (180:90:0.4);\n  \\draw[->] (1.9,0.6) arc (0:-90:0.4);\n\n  \\draw[decorate, decoration=snake] (2.1,-.2) arc [start angle=0, end angle=-180, radius=0.6cm];\n\n\\end{tikzpicture}\n\n\\end{document}\n\"\"\"\n\nwith open(\"diagrams.tex\", \"w\") as f:\n    f.write(latex_code)\n\nimport re\n\ndef scale_svg(file_path, factor):\n    \"\"\"\n    Reads an SVG file and scales its width and height attributes.\n    \"\"\"\n    with open(file_path, 'r') as f:\n        content = f.read()\n    \n    # Define a function to perform the scaling on matched values\n    def scale_match(match):\n        value = float(match.group(2)) # Fix: changed from group(1) to group(2)\n        new_value = value * factor\n        return f'{match.group(1)}=\"{new_value:.3f}{match.group(3)}\"'\n        \n    # Regex to find width=\"[number]pt\" and height=\"[number]pt\"\n    # and replace them with the scaled value\n    scaled_content = re.sub(r'(width|height)=\"([\\d.]+)(pt|px)?\"', scale_match, content)\n\n    with open(file_path, 'w') as f:\n        f.write(scaled_content)\n\n# Define the list of diagram names\ndiagram_names = [\"electron\", \"positron\", \"photon\", \"vertex\", \"compton\", \"annihil\", \"SE\", \"VP\", \"SSEE\", \"SVPE\" ]\n\n# Run the commands, redirecting all output to the null device\nwith open(os.devnull, 'w') as FNULL:\n    # Compile the LaTeX file to PDF\n    subprocess.run([\"lualatex\", \"-interaction=nonstopmode\", \"diagrams.tex\"], stdout=FNULL, stderr=FNULL)\n\n    # Convert the PDF pages to SVG\n    # Use a loop to process each diagram\n    for i, name in enumerate(diagram_names):\n        page_number = i + 1\n        output_svg = f\"{name}.svg\"\n        \n        # Convert the PDF page to a specific SVG file\n        subprocess.run([\"pdf2svg\", \"diagrams.pdf\", output_svg, str(page_number)], stdout=FNULL, stderr=FNULL)        \n        # Scale the newly created SVG file\n        scale_svg(output_svg, 2)\n\n    # Clean up temporary files\n    subprocess.run([\"rm\", \"diagrams.tex\", \"diagrams.pdf\", \"diagrams.log\", \"diagram.aux\"], stdout=FNULL, stderr=FNULL)\n```\n\n\n\n\n# 1. Historical Background\n\n## 1.1 The Lamb–Retherford Experiment\n\nIn 1947, **Willis Lamb** and **Robert Retherford** carried out a groundbreaking experiment at Columbia University that revealed a subtle but profound flaw in the then-current understanding of atomic structure.  \n\nAccording to the **Dirac equation**, the states $2S_{1/2}$ and $2P_{1/2}$ of the hydrogen atom should be **exactly degenerate**—that is, they should have the same energy. This prediction was an improvement over the **Schrödinger theory**, which did not account for spin or relativistic effects. Yet when Lamb and Retherford used microwave spectroscopy to measure transitions between these states, they found a tiny but unmistakable **energy difference of about 1058 MHz**.  \n\nThis unexpected result, now known as the **Lamb shift**, demonstrated that neither Schrödinger’s nor Dirac’s framework was the full story. Both theories still treated the electromagnetic field **classically**, neglecting the fact that the field itself must also be quantized.\n\n::: callout-note\n## The Lamb–Retherford Experiment (1947)\n- **Setup**: Microwave spectroscopy of hydrogen atoms.  \n- **Expectation (Dirac theory)**: $2S_{1/2}$ and $2P_{1/2}$ states should be degenerate (same energy).  \n- **Result**: An observed frequency shift of **1058 MHz** (about $4.4 \\,\\mu$eV).  \n- **Conclusion**: A new effect beyond Dirac’s equation — now called the **Lamb shift**.  \n:::\n\n### Experimental Setup\n\nThe experimental arrangement designed by Willis Lamb and Robert Retherford in the late 1940s was carefully constructed to probe the fine details of hydrogen’s energy levels. \n\n```{python}\n#| echo: false\n#| fig-format: png\n#| fig-align: center\n#| fig-alt: The Lamb–Retherford Experiment (1947).\nimport matplotlib.pyplot as plt\nimport matplotlib.patches as patches\nimport matplotlib.lines as mlines\nimport random\nimport numpy as np\n\n# Set up the figure and axes\nfig, ax = plt.subplots(figsize=(8, 4.5))\nax.set_xlim(0, 800)\nax.set_ylim(0, 450)\nax.invert_yaxis()  # Invert y-axis to match SVG's top-down coordinate system\nax.set_aspect('equal', adjustable='box') # Ensure correct aspect ratio\n\n# Hide axes, ticks, and spines\nax.set_axis_off()\n\n# Set up styles (equivalent to SVG CSS classes)\nfont_props_bold = {'fontfamily': 'sans-serif', 'fontsize': 10}\nfont_props_title = {'fontfamily': 'Arial', 'fontweight': 'bold', 'fontsize': 18}\nfont_props_subtitle = {'fontfamily': 'Arial', 'fontstyle': 'italic', 'fontsize': 14}\nfont_props_small = {'fontfamily': 'sans-serif', 'fontstyle': 'italic', 'fontsize': 8}\n\n# 1. OVEN\noven = patches.Rectangle((50, 150), 80, 100, linewidth=2, edgecolor='black', facecolor='#CCCCCC')\nax.add_patch(oven)\n\n# H atoms dots in oven\nrandom.seed(42)  # For reproducible randomness\nnum_atoms = 80\nx_atoms = [random.uniform(55, 125) for _ in range(num_atoms)]\ny_atoms = [random.uniform(155, 245) for _ in range(num_atoms)]\nax.scatter(x_atoms, y_atoms, s=2, color='black') # s=8 is a good visual equivalent for r=1.5\nax.text(90, 270, 'Oven', ha='center', va='center',  **font_props_bold)\n\n# 2. H ATOMS BEAM\nax.plot([130, 700], [200, 200], color='black', linewidth=3, solid_capstyle='butt')\nax.annotate('', xy=(700, 200), xytext=(690, 200), arrowprops=dict(facecolor='black', shrink=0.05, width=2, headwidth=8))\nax.text(175, 185, 'H atoms', ha='center', va='center', **font_props_bold)\nax.text(175, 220, r'1 $S_{1/2}$', ha='center', va='center', **font_props_bold)\n\n\n## **Electron Source & Excitation**\n# 3. ELECTRON SOURCE\nfilament_y = 350\nx_filament = [254, 259, 266, 273, 280, 285]\ny_filament = [filament_y, filament_y + 5, filament_y - 5, filament_y + 5, filament_y - 5, filament_y]\nax.plot(x_filament, y_filament, color='red', linewidth=3)\nax.plot([254, 254], [filament_y, filament_y + 10], color='black', linewidth=1)\nax.plot([285, 285], [filament_y, filament_y + 10], color='black', linewidth=1)\n\n# Electron beam\n#v_arrow_head = patches.FancyArrowPatch((0, 0), (0, 0), arrowstyle='-|>', mutation_scale=10, fc='blue')\nfor i in range(8):\n    start_x = 270 + random.uniform(-1, 1)\n    end_x = 270 + random.gauss(0, 6)\n#    ax.annotate('', xy=(end_x, 90), xytext=(start_x, 330), \n#                 arrowprops=dict(facecolor='blue', shrink=0.05, width=0.5, headwidth=4))\n    plt.arrow(\n        x=270 + random.uniform(-1, 1),\n        y=330,\n        dx=random.gauss(0, 6),\n        dy=-240,\n        width=0.2, # Controls the stem width\n        head_width=5,\n        head_length=15,\n        color='blue',\n        length_includes_head=True\n    )\n\n\n\n# Electron source labels\nax.text(270, 385, 'Electron', ha='center', va='center', **font_props_bold)\nax.text(270, 400, 'source', ha='center', va='center', **font_props_bold)\nax.text(270, 415, '(heated filament)', ha='center', va='center', **font_props_small)\n\n# 4. METASTABLE STATE LABELS\nax.text(400, 185, 'H atoms', ha='center', va='center', **font_props_bold)\nax.text(400, 220, r'2 $S_{1/2}$', ha='center', va='center', **font_props_bold)\n\n\n## **Resonator & Detection**\n# 5. RESONATOR\nresonator = patches.Rectangle((480, 120), 110, 160, linewidth=2, edgecolor='black', facecolor='#E6F3FF', alpha=0.5)\nax.add_patch(resonator)\nfor i in range(12):\n    x = 490 + i*8\n    ax.plot([x, x], [130, 270], color='black', linewidth=1, alpha=0.7)\nax.text(540, 300, 'Resonator', ha='center', va='center', **font_props_bold)\n#ax.text(540, 315, 'tunable', ha='center', va='center', **font_props_bold)\nax.text(540, 330, '1 ... 10 GHz', ha='center', va='center', **font_props_bold)\n\n# 7. TUNGSTEN FOIL DETECTOR\nax.plot([700, 720], [160, 240], color='black', linewidth=3)\nax.text(710, 140, 'W foil', ha='center', va='center', **font_props_bold)\n\n# 8. DETECTION CIRCUIT\nax.text(670, 230, r'$e^{-}$', ha='center', va='center', **font_props_bold)\n#ax.annotate('', xy=(680, 240), xytext=(710, 203), \n#             arrowprops=dict(facecolor='blue', shrink=0.05, width=1.5, headwidth=4))\nax.plot([660, 696], [245, 245], color='black', linewidth=2)\n\nplt.arrow(\n    x=710,\n    y=203,\n    dx=-30,\n    dy=37,\n    width=0.5, # Controls the stem width\n    head_width=9,\n    head_length=9,\n    color='blue',\n    length_includes_head=True\n)\n\n# Wires\nax.plot([678, 678], [245, 280], color='black', linewidth=1)\nax.plot([678, 710], [280, 280], color='black', linewidth=1)\nax.plot([750, 780], [280, 280], color='black', linewidth=1)\nax.plot([710, 780], [200, 200], color='black', linewidth=1)\nax.plot([780, 780], [200, 320], color='black', linewidth=1)\n\n# Ammeter\nammeter = patches.Circle((730, 280), radius=20, edgecolor='black', facecolor='white', linewidth=2)\nax.add_patch(ammeter)\nax.text(730, 280, 'A', ha='center', va='center', fontweight='bold', fontsize=14)\n\n# Ground symbol\nax.plot([765, 795], [320, 320], color='black', linewidth=1)\nax.plot([770, 790], [325, 325], color='black', linewidth=1)\nax.plot([775, 785], [330, 330], color='black', linewidth=1)\n\n# Save the figure\nplt.show()\n\n```\n\nThe apparatus can be understood in several stages:\n\n1. **Oven and hydrogen beam formation.**  \n   In the oven, molecular hydrogen gas is dissociated into atomic hydrogen. A small opening allows a **collimated beam of hydrogen atoms** to emerge. Most atoms in the beam are in the **ground state** ($1S_{1/2}$).\n\n2. **Electron source and collisional excitation.**  \n   The atomic beam passes through a region where it is intersected by a beam of electrons, produced by a heated filament. Collisions between the electrons and hydrogen atoms transfer energy and excite a fraction of the atoms into higher states.  \n   Importantly, a significant number of atoms are promoted into the **metastable $2S_{1/2}$ state**. This state is long-lived because electric-dipole transitions to the ground state are forbidden by selection rules.\n\n3. **Microwave resonator.**  \n   The hydrogen beam then enters a **tunable microwave cavity resonator**, typically in the frequency range of **1–10 GHz**. Inside the resonator, the $2S_{1/2}$ atoms can absorb microwave photons. If the applied frequency corresponds to the energy difference between nearby levels, the atoms are stimulated to make transitions into short-lived states (such as $2P_{1/2}$).\n\n4. **Detection region.**  \n   At the end of the beam line, the hydrogen atoms encounter a thin **tungsten foil**. Ground-state atoms ($1S_{1/2}$) pass through the foil without significant interaction, but atoms in excited states are quenched upon contact, leading to the emission of electrons.  \n\n   These electrons are collected and amplified in a simple **circuit with an ammeter**, allowing the experimenters to monitor the number of atoms in the metastable state as a function of the resonator frequency.\n\nIn summary, the setup combines a **source of atomic hydrogen**, **excitation to a metastable state**, a **microwave cavity for inducing transitions**, and a **detector sensitive to de-excitation processes**. This arrangement enables a very sensitive probe of small energy differences between atomic states.\n\n\n\n---\n\n## 1.2 Theoretical Challenges\n\nPhysicists quickly realized that explaining the Lamb shift required a fully **quantum field theoretical** treatment, where the electron interacts with a quantized electromagnetic field. However, when theorists attempted such calculations, they encountered serious problems: the integrals describing electron–photon interactions diverged to infinity.  \n\nThis was alarming—if taken at face value, it would mean that quantum electrodynamics (QED) produced nonsensical, infinite predictions. A new conceptual framework was needed.\n\n---\n\n## 1.3 Renormalization and the Birth of QED\n\nThe breakthrough came through the work of several theorists, including **Hans Bethe, Julian Schwinger, Richard Feynman, Sin-Itiro Tomonaga,** and later **Freeman Dyson**, who clarified and unified the emerging ideas.  \n\n- **Hans Bethe (1947)** provided the first non-relativistic calculation of the Lamb shift shortly after Lamb’s experimental result. Remarkably, Bethe managed to extract a finite correction by introducing a **cutoff** and subtracting infinities in a physically meaningful way.  \n- **Julian Schwinger, Richard Feynman,** and **Sin-Itiro Tomonaga** independently developed consistent and mathematically rigorous formulations of QED in the late 1940s.  \n- **Freeman Dyson** showed the equivalence of these approaches and placed them in the framework of **renormalization theory**, where infinities could be systematically absorbed into redefined (\"renormalized\") quantities like the electron’s charge and mass.  \n\nThis renormalization procedure transformed QED from a seemingly hopeless theory into one of the most accurate and predictive frameworks in all of physics.\n\n---\n\n## 1.4 Legacy\n\nThe successful explanation of the Lamb shift was a decisive victory for quantum field theory and marked the **birth of modern QED**. Since then, QED has become the most precisely tested theory in science: its predictions, such as the anomalous magnetic moment of the electron, have been confirmed to extraordinary accuracy (better than one part in $10^{12}$).  \n\nThe Lamb shift thus stands not only as an experimental milestone but also as the historical bridge between early quantum mechanics and the modern quantum field theories that underpin our current understanding of fundamental physics.\n\n\n# 2. Feynman diagrams — picturing QED processes\n\nFeynman diagrams are a graphical shorthand used in quantum electrodynamics (QED) and other quantum field theories to represent terms in the perturbative expansion of interaction amplitudes. They serve as visual mnemonics: lines correspond to particles propagating through spacetime, and vertices represent interactions where particles meet and exchange energy or momentum.  \n\n\n\n## 2.1 Basic elements\n\n- **Electron (fermion) propagator**:  \n  A straight line with an arrow pointing **forward in time** (usually drawn upward or left-to-right) represents an electron moving through spacetime.\n\n![](electron.svg){fig-alt=\"Feynman diagram of a free electron.\" fig-align=\"center\" width=30%}\n\n- **Positron (antifermion) propagator**:  \n  A straight line with an arrow pointing **opposite to the time direction** represents the electron’s antiparticle, the positron.  \n\n  :::{.callout-note}\n  ## Why opposite arrows?  \n  This is a consequence of **CPT invariance**: charge conjugation (C), parity inversion (P), and time reversal (T) symmetry together mean that a positron moving forward in time can be equivalently viewed as an electron moving backward in time.  \n  :::  \n\n![](positron.svg){fig-alt=\"Feynman diagram of a free positron.\" fig-align=\"center\" width=30%}\n\n- **Photon propagator**:  \n  A wavy line represents the photon, the mediator of the electromagnetic interaction. Photons are massless and always move at the speed of light.  \n\n![](photon.svg){fig-alt=\"Feynman diagram of a photon.\" fig-align=\"center\" width=30%}\n\n- **Interaction vertex**:  \n  A point where one photon line meets two fermion lines. This encodes the **electromagnetic coupling** (mathematically written as $-ie\\gamma^\\mu$). At each vertex:  \n  - **Charge conservation** always holds: the electron keeps its charge $(-e)$, or an electron–positron pair may annihilate into a photon.  \n  - **Momentum conservation** also always holds.  \n  - **Energy conservation** is respected *globally*, but at very short timescales, “energy borrowing” is possible due to the uncertainty principle ($\\Delta E \\, \\Delta t \\gtrsim \\hbar$). These transient violations are what allow *virtual photons* to exist inside Feynman diagrams.  \n\n![](vertex.svg){fig-alt=\"A vertex in a Feynman diagram.\" fig-align=\"center\" width=30%}\n\n\n\n---\n\n## 2.2 Examples\n\nFeynman diagrams are not just abstract symbols — they represent real processes that can be measured:\n\n- **Compton scattering** (electron–photon scattering):  \n  An electron absorbs a photon and re-emits another photon, changing its direction.  \n\n![](compton.svg){fig-alt=\"The Feynman diagram of Compton scattering.\" fig-align=\"center\" width=30%}\n\n\n- **Electron–positron annihilation**:  \n  An electron and positron annihilate, producing two photons (to conserve momentum).  \n\n![](annihil.svg){fig-alt=\"The Feynman diagram of electron-positron annihilation.\" fig-align=\"center\" width=30%}\n\n\n# 3. Physical origins of the Lamb shift\n\nThe Lamb shift arises from subtle quantum effects beyond the Dirac equation. These effects require the framework of quantum electrodynamics (QED), where both matter and the electromagnetic field are quantized. Several physical mechanisms contribute:\n\n## 3.1 Electron self-energy\nThe electron is not a point particle moving through empty space — it constantly interacts with its own electromagnetic field. In QED, this appears as the electron emitting and then reabsorbing a **virtual photon**.  \n\nThis process alters the effective mass and binding energy of the electron, leading to small shifts in the energy levels. The effect is stronger for states where the electron wavefunction has significant probability density near the nucleus, such as the $2s_{1/2}$ state in hydrogen.  \n\n::: {.note}\n**Feynman diagram:**  \nSelf-energy of a bound electron is represented by a **double line** (electron in a bound state) with a photon loop attached.  \n\n![](SE.svg){fig-alt=\"Self energy Feynman diagram.\" fig-align=\"center\" width=30%}\n:::\n\n\n---\n\n## 3.2 Vacuum polarization\nThe vacuum in QED is not empty: quantum fluctuations continually create and annihilate **virtual electron–positron pairs**. A real or virtual photon propagating through the vacuum can briefly convert into such a pair before recombining.  \n\nThis changes the effective photon propagator, which in turn modifies the Coulomb potential between the nucleus and electron. The result is a slight *screening* of the nuclear charge, which again shifts atomic energy levels.  \n\n::: {.note}\n**Feynman diagram:**  \nVacuum polarization is represented by a photon line that develops a closed electron–positron loop. For bound states, the photon is attached to the double line of the bound electron.  \n\n![](VP.svg){fig-alt=\"Vacuum polarization Feynman diagram.\" fig-align=\"center\" width=30%}\n:::\n\n---\n\n## 3.3 Finite nuclear size\nSo far, we have treated the nucleus as a pointlike particle producing a Coulomb potential. In reality, nuclei have a finite spatial extension, with a charge distribution that smears out the potential at very short distances.  \n\nFor $s$-states, whose wavefunctions penetrate the nucleus, this modification alters the energy levels. While not a QED effect, it is always included in Lamb shift analyses, particularly for heavy nuclei.\n\n---\n\n## 3.4 Higher-order QED contributions\nThe Feynman diagrams discussed so far represent the leading-order QED corrections (lowest powers of the fine-structure constant $\\alpha$). In practice, higher-order diagrams — involving multiple photon exchanges, loops, or vertex corrections — also contribute.  \n\n![](SSEE.svg){fig-alt=\"Second order self energy Feynman diagram.\" fig-align=\"center\" width=30%}\n![](SVPE.svg){fig-alt=\"Second order self energy with vacuum polarization Feynman diagram.\" fig-align=\"center\" width=30%}\n\nThese are systematically included using **perturbation theory**. The expansion parameter is $\\alpha Z$, where $\\alpha \\approx 1/137$ is the fine-structure constant and $Z$ is the nuclear charge. For light atoms like hydrogen, higher-order terms are tiny, but for heavier nuclei (large $Z$) they become increasingly important.  \n\n\n\n\n---\n\n## Summary\nThe Lamb shift is not the result of a single effect, but rather the interplay of self-energy, vacuum polarization, nuclear size corrections, and higher-order QED processes. Its accurate theoretical calculation required the development of renormalized QED — one of the most successful and precise theories in physics.\n\n\n\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"embed-resources":true,"self-contained":true,"html-math-method":"mathjax","output-file":"lamb.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.8.24","theme":"cosmo","fig-alt":true,"title":"The Lamb Shift — An Introduction to Quantum Electrodynamics","author":"Daniel Fischer"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}