{
  "hash": "101f1230457e827fda790d94f78bfde0",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Orbital Angular Momentum in Quantum Mechanics\nauthor: Daniel Fischer\n#engine: python3\n#jupyter: python3\n---\n\n# Orbital angular momentum: overview and plan\n\nThis chapter provides a comprehensive introduction to the quantum mechanical treatment of orbital angular momentum. We will derive the operators for angular momentum and solve the corresponding eigenvalue problem, which is fundamental to understanding the behavior of many quantum systems, including the hydrogen atom.\n\nThe specific goals for this chapter are:\n\n1. Derive the quantum mechanical operator for orbital angular momentum, $\\hat{\\vec L}$, and analyze its key commutation relations.\n2. Employ the method of separation of variables in spherical coordinates to transform the eigenvalue problem into a set of angular ordinary differential equations (ODEs).\n3. Solve these ODEs to determine the quantized eigenvalues of $\\hat L^2$ and its components, and find the corresponding eigenfunctions.\n\n---\n\n# 1. Angular Momentum in Cartesian Coordinates\n\nIn **classical mechanics**, the angular momentum is defined as the cross product\n$$\n\\vec L = \\vec r \\times \\vec p,\n$$\nwith\n$$\n\\vec r =\n\\begin{pmatrix}\nx \\\\ y \\\\ z\n\\end{pmatrix},\n\\quad\n\\vec p =\n\\begin{pmatrix}\np_x \\\\ p_y \\\\ p_z\n\\end{pmatrix}.\n$$\n\nThe cross product gives\n$$\n\\vec L =\n\\begin{pmatrix}\nL_x \\\\ L_y \\\\ L_z\n\\end{pmatrix}\n=\n\\begin{pmatrix}\ny p_z - z p_y \\\\\nz p_x - x p_z \\\\\nx p_y - y p_x\n\\end{pmatrix}.\n$$\n\nIn **quantum mechanics**, we replace position and momentum by operators:\n\n$$\n\\hat{\\vec r} =\n\\begin{pmatrix}\n\\hat x \\\\ \\hat y \\\\ \\hat z\n\\end{pmatrix},\n\\qquad\n\\hat{\\vec p} =\n\\begin{pmatrix}\n\\hat p_x \\\\ \\hat p_y \\\\ \\hat p_z\n\\end{pmatrix},\n\\qquad\n\\hat{\\vec L} = \\hat{\\vec r} \\times \\hat{\\vec p}.\n$$\n\nIn the coordinate representation (position basis), we have\n\n$$\n\\hat{\\vec r} =\n\\begin{pmatrix}\nx \\\\ y \\\\ z\n\\end{pmatrix},\n\\qquad\n\\hat{\\vec p} =\n-i\\hbar\n\\begin{pmatrix}\n\\frac{\\partial}{\\partial x} \\\\\n\\frac{\\partial}{\\partial y} \\\\\n\\frac{\\partial}{\\partial z}\n\\end{pmatrix}.\n$$\n\nTherefore, the angular momentum operator is\n\n$$\n\\hat{\\vec L} =\n\\begin{pmatrix}\n\\hat L_x \\\\ \\hat L_y \\\\ \\hat L_z\n\\end{pmatrix}\n=\n-i\\hbar\n\\begin{pmatrix}\ny\\frac{\\partial}{\\partial z} - z\\frac{\\partial}{\\partial y} \\\\\nz\\frac{\\partial}{\\partial x} - x\\frac{\\partial}{\\partial z} \\\\\nx\\frac{\\partial}{\\partial y} - y\\frac{\\partial}{\\partial x}\n\\end{pmatrix}.\n$$\n\n---\n\n## 1.1 Commutation Relations\n\nFrom the canonical commutation relations\n$$\n[\\hat x_i, \\hat p_j] = i\\hbar \\,\\delta_{ij}, \n\\quad\n[\\hat x_i, \\hat x_j] = 0,\n\\quad\n[\\hat p_i, \\hat p_j] = 0,\n$$\none can compute\n$$\n[\\hat L_x, \\hat L_y] = i\\hbar \\hat L_z, \\qquad\n[\\hat L_y, \\hat L_z] = i\\hbar \\hat L_x, \\qquad\n[\\hat L_z, \\hat L_x] = i\\hbar \\hat L_y.\n$$\n\n::: {.callout-note collapse=\"true\"}\n### Proof\n\nThe angular momentum components are\n$$\n\\hat L_x = \\hat y \\hat p_z - \\hat z \\hat p_y, \\qquad\n\\hat L_y = \\hat z \\hat p_x - \\hat x \\hat p_z, \\qquad\n\\hat L_z = \\hat x \\hat p_y - \\hat y \\hat p_x.\n$$\n\nCompute the commutator:\n$$\n\\begin{aligned}\n{[\\hat L_x, \\hat L_y]} &= [\\hat y \\hat p_z - \\hat z \\hat p_y, \\; \\hat z \\hat p_x - \\hat x \\hat p_z] \\\\\n&= [\\hat y \\hat p_z, \\hat z \\hat p_x] \n- [\\hat y \\hat p_z, \\hat x \\hat p_z] \n- [\\hat z \\hat p_y, \\hat z \\hat p_x] \n+ [\\hat z \\hat p_y, \\hat x \\hat p_z].\n\\end{aligned}\n$$\n\nExpanding and using the canonical commutators $[\\hat x_i, \\hat p_j] = i\\hbar \\delta_{ij}$ and $[\\hat x_i, \\hat x_j] = [\\hat p_i, \\hat p_j] = 0$:\n\n1. $[\\hat y \\hat p_z, \\hat z \\hat p_x] = \\hat y [\\hat p_z, \\hat z] \\hat p_x = -i\\hbar \\hat y \\hat p_x$  \n2. $-[\\hat y \\hat p_z, \\hat x \\hat p_z] = 0$  \n3. $-[\\hat z \\hat p_y, \\hat z \\hat p_x] = 0$\n4. $[\\hat z \\hat p_y, \\hat x \\hat p_z] = \\hat x [\\hat z, \\hat p_z] \\hat p_y = i\\hbar \\hat x \\hat p_y$\n\nAdding the nonzero terms gives\n$$\n[\\hat L_x, \\hat L_y] = i\\hbar (\\hat x \\hat p_y - \\hat y \\hat p_x) = i\\hbar \\hat L_z.\n$$\n\nThus the commutator is verified. The remaining commutators, $[\\hat L_y, \\hat L_z]$ and $[\\hat L_z, \\hat L_x]$, can be derived using the same method.\n\n\n:::\n\nThese relations show:\n\n::: {.callout-caution}\n- The three components $\\hat L_x, \\hat L_y, \\hat L_z$ **do not commute**.  \n- Thus, there are **no eigenstates of the full vector operator** $\\hat{\\vec L}$.\n:::\n\n\n---\n\n## 1.2 Total Angular Momentum\n\nThe squared operator is defined as\n$$\n\\hat L^2 = \\hat L_x^2 + \\hat L_y^2 + \\hat L_z^2.\n$$\n\nIt satisfies\n$$\n[\\hat L^2, \\hat L_x] = [\\hat L^2, \\hat L_y] = [\\hat L^2, \\hat L_z] = 0.\n$$\n\nHence, we can find simultaneous eigenstates of $\\hat L^2$ and one component, usually chosen to be $\\hat L_z$.\n\n::: {#cell-fig-momentumvec .cell fig-format='svg' execution_count=1}\n``` {.python .cell-code}\nimport matplotlib.pyplot as plt\nimport numpy as np\n\n# Create a new figure and a 3D axis\nfig = plt.figure(figsize=(10, 8))\nax = fig.add_subplot(111, projection='3d')\n\n# Set the aspect ratio to 'equal' for better visualization\nax.set_box_aspect([1,1,1])\n\n# Define the components of the angular momentum vector L\nLx = 3\nLy = 4\nLz = 6\n\n# The origin of the vectors\norigin = [0, 0, 0]\n\n# Plot the angular momentum vector L\nax.quiver(*origin, Lx, Ly, Lz, color='red', label=r'$\\vec{L}$', arrow_length_ratio=0.15)\n\n# Plot the z-component vector Lz\nax.quiver(*origin, 0, 0, Lz, color='blue', linestyle='--', arrow_length_ratio=0.1)\n\n# Plot the x, y, and z unit vectors\nax.quiver(*origin, 1, 0, 0, color='gray', arrow_length_ratio=0.3)\nax.quiver(*origin, 0, 1, 0, color='gray', arrow_length_ratio=0.3)\nax.quiver(*origin, 0, 0, 1, color='gray', arrow_length_ratio=0.3)\n\n# Add labels for the unit vectors\nax.text(1.2, 0, 0, 'x', color='gray', fontsize=12)\nax.text(0, 1.2, 0, 'y', color='gray', fontsize=12)\nax.text(0, 0, 1.2, 'z', color='gray', fontsize=12)\n\n# Set title\n# ax.set_title('Quantum Mechanical Angular Momentum Vector', fontsize=16)\n\n# Plot the circle of possible endpoints for the L vector\nradius = np.sqrt(Lx**2 + Ly**2)\ntheta = np.linspace(0, 2 * np.pi, 100)\nx_circle = radius * np.cos(theta)\ny_circle = radius * np.sin(theta)\nz_circle = np.full_like(theta, Lz)\nax.plot(x_circle, y_circle, z_circle, color='green', linestyle=':', label='Uncertainty Circle')\n\n# Add annotations for vector lengths, adjusted for better visibility\nlambda_val = Lx**2 + Ly**2 + Lz**2\nmu_val = Lz\nax.text(Lx * 0.7, Ly * 0.6, Lz * 0.4, r'$\\sqrt{\\lambda}$', color='red', fontsize=14, horizontalalignment='left')\nax.text(0.5, 0.5, Lz * 0.5, r'$\\mu$', color='blue', fontsize=14, horizontalalignment='left')\n\n# Set the plot limits\nax.set_xlim([-5, 5])\nax.set_ylim([-5, 5])\nax.set_zlim([0, 7])\n\n# Remove background planes and main axes lines, but keep the specific unit vectors\nax.set_axis_off()\n\n# Remove grid\nax.grid(False)\n\n# Save the plot\n#plt.savefig('angular_momentum_final.png')\n\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Momentum Eigenvector in Quantum Mechanics.](angmom_files/figure-html/fig-momentumvec-output-1.png){#fig-momentumvec width=611 height=611 fig-alt='Momentum Eigenvector in Quantum Mechanics.'}\n:::\n:::\n\n\n---\n\n# 2. Angular Momentum Operators in Spherical Coordinates\n\nThe angular momentum operators in position representation act on wavefunctions $\\psi(r,\\theta,\\varphi)$, where $(r,\\theta,\\varphi)$ are spherical coordinates:\n\n$$\nx = r\\sin\\theta\\cos\\varphi, \\quad\ny = r\\sin\\theta\\sin\\varphi, \\quad\nz = r\\cos\\theta\n$$\n\nThe derivatives transform as:\n\n$$\n\\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y}, \\frac{\\partial}{\\partial z} \\quad \\rightarrow \\quad \\frac{\\partial}{\\partial r}, \\frac{\\partial}{\\partial \\theta}, \\frac{\\partial}{\\partial \\varphi}\n$$\n\nAfter some algebra (using the chain rule), the z-component simplifies nicely to:\n\n$$\n\\hat{L}_z = -i\\hbar \\frac{\\partial}{\\partial \\varphi}.\n$$\n\n\nThe squared angular momentum operator also transforms to spherical coordinates. Using the spherical Laplacian $\\nabla^2$ and the fact that $\\hat{L}^2$ acts only on angular variables:\n\n$$\n\\hat{L}^2 = -\\hbar^2 \\left[ \\frac{1}{\\sin\\theta}\\frac{\\partial}{\\partial\\theta}\\!\\Big(\\sin\\theta\\frac{\\partial}{\\partial\\theta}\\Big)\n+ \\frac{1}{\\sin^2\\theta}\\frac{\\partial^2}{\\partial\\varphi^2} \\right].\n$$\n\nWe seek functions $Y(\\theta,\\varphi)$ that are simultaneous eigenfunctions:\n\n$$\n\\hat{L}^2 Y(\\theta,\\varphi) = \\lambda\\, Y(\\theta,\\varphi), \\qquad\n\\hat{L}_z Y(\\theta,\\varphi) = \\mu\\, Y(\\theta,\\varphi).\n$$\n\n---\n\n# 3. Separation of Variables\n\nWe try the product form\n\n$$\nY(\\theta,\\varphi)=\\Theta(\\theta)\\,\\Phi(\\varphi).\n$$\n\n---\n\n## 3.1 Eigenfunctions of $\\hat{L}_z$\n\nApplying $\\hat{L}_z$ gives:\n\n$$\n\\hat{L}_z Y = -i\\hbar \\frac{\\partial}{\\partial \\varphi}(\\Theta(\\theta)\\Phi(\\varphi))\n= -i\\hbar \\Theta(\\theta) \\frac{d\\Phi}{d\\varphi}.\n$$\n\nThus $\\Phi$ must satisfy:\n\n$$\n\\frac{d\\Phi}{d\\varphi} = i m \\Phi, \\quad m \\in \\mathbb{Z}.\n$$\n\nThe solutions are:\n\n$$\n\\Phi(\\varphi) = e^{im\\varphi}, \\qquad \\mu = \\hbar m.\n$$\n\n---\n\n## 3.2 Equation for $\\Theta(\\theta)$\n\nSubstituting into the $\\hat{L}^2$ eigenvalue equation:\n\n$$\n\\frac{1}{\\sin\\theta}\\frac{d}{d\\theta}\\!\\Big(\\sin\\theta\\frac{d\\Theta}{d\\theta}\\Big)\n- \\frac{m^2}{\\sin^2\\theta}\\Theta + \\ell(\\ell+1)\\Theta = 0,\n$$\n\nwhere we have set $\\lambda = \\hbar^2 \\ell(\\ell+1)$.  \n\nLet $x = \\cos\\theta$. Then the equation becomes:\n\n$$\n\\frac{d}{dx}\\Big[(1-x^2)\\frac{dP}{dx}\\Big] + \\Big[\\ell(\\ell+1) - \\frac{m^2}{1-x^2}\\Big] P(x) = 0.\n$$\n\nThis is the **associated Legendre equation**. The physically acceptable solutions to this equation are the **associated Legendre functions**, $P_\\ell^m(x)$ , which are defined in terms of the standard **Legendre polynomials** $P_\\ell(x)$:\n\n$$\nP_\\ell^m(x) = (1-x^2)^{m/2} \\frac{d^m}{dx^m} P_\\ell(x).\n$$\n\nThe Legendre polynomials $P_\\ell(x)$ can be constructed explicitly as (Rodrigues' Formula):\n\n$$\nP_\\ell(x) = \\frac{1}{2^\\ell \\ell!} \\frac{d^\\ell}{dx^\\ell} \\big[(x^2-1)^\\ell\\big].\n$$\n\n\n---\n\n## 3.3 General result\n\n::: {.callout-tip}\n## General Form of Spherical Harmonics\n\nCombining both angular parts, the eigenfunctions are:\n\n$$\nY_\\ell^m(\\theta,\\varphi) = N_{\\ell m}\\, P_\\ell^m(\\cos\\theta)\\, e^{i m \\varphi},\n$$\n\nwith normalization constant\n\n$$\nN_{\\ell m} = (-1)^m \\sqrt{\\frac{2\\ell+1}{4\\pi}\\,\\frac{(\\ell-m)!}{(\\ell+m)!}}.\n$$\n:::\n\n::: {.callout-tip}\n## Eigenvalue Equations\n\nThe spherical harmonics satisfy:\n\n$$\n\\hat{L}^2 Y_{\\ell}^{m} = \\hbar^2 \\ell(\\ell+1) Y_{\\ell}^{m}, \\qquad\n\\hat{L}_z Y_{\\ell}^{m} = \\hbar m Y_{\\ell}^{m}.\n$$\n\nThus $Y_\\ell^m$ are simultaneous eigenfunctions of both $\\hat{L}^2$ and $\\hat{L}_z$.\n:::\n\n\n::: {.callout-tip}\n## Orthonormality\n\nThe spherical harmonics satisfy:\n\n$$\n\\int_0^{2\\pi}\\!\\int_0^\\pi Y_\\ell^m(\\theta,\\varphi)^*\\,Y_{\\ell'}^{m'}(\\theta,\\varphi)\\,\n\\sin\\theta \\, d\\theta\\, d\\varphi\n= \\delta_{\\ell\\ell'}\\delta_{mm'}.\n$$\n\nThus, $\\{Y_\\ell^m\\}$ forms a complete orthonormal basis for functions on the sphere.\n:::\n\n---\n\n# 4. Quantization of $\\ell$ and $m$\n\nThe requirement that the eigenfunctions be single-valued and finite on the sphere leads to restrictions on $\\ell$ and $m$.\n\n- From the $\\varphi$-dependence:  \n  The solution is $\\Phi(\\varphi) = e^{i m \\varphi}$.  \n  For this to be single-valued when $\\varphi \\to \\varphi + 2\\pi$, we must have  \n  $$\n  e^{i m (\\varphi + 2\\pi)} = e^{i m \\varphi}.\n  $$\n  This holds only if $m \\in \\mathbb{Z}$ (an integer).  \n  Thus, the magnetic quantum number $m$ is an integer.\n\n- From the $\\theta$-dependence:  \n  The function $\\Theta(\\theta)$ must be finite at the poles ($\\theta=0,\\pi$).  \n  This condition restricts the separation constant to the form  \n  $$\n  \\lambda = \\hbar^2 \\ell(\\ell+1),\n  $$\n  with $\\ell = 0, 1, 2, \\dots$.  \n  If $\\ell$ were not an integer, the associated Legendre functions $P_\\ell^m(\\cos\\theta)$ would diverge or fail to be single-valued.  \n  Thus, the orbital quantum number $\\ell$ must be a non-negative integer.\n\n- For each $\\ell$, the allowed $m$ values are integers satisfying $-\\ell \\le m \\le \\ell$.  \n  This ensures that the associated Legendre functions $P_\\ell^m(\\cos\\theta)$ remain well-defined and normalizable.\n\nTherefore, we obtain:\n\n::: {.callout-tip}\n## Quantization rules\n$$\n\\ell = 0, 1, 2, \\dots, \\qquad m = -\\ell, -\\ell+1, \\dots, \\ell-1, \\ell.\n$$\n\nThe $\\theta$-dependence is given explicitly by the **associated Legendre functions** $P_\\ell^m(\\cos\\theta)$.\n:::\n\n\n---\n\n# 5. Ladder Operators and $m$-States\n\nTo understand the structure of the angular momentum eigenstates, it is useful to introduce the **ladder operators**:\n\n$$\n\\hat{L}_\\pm = \\hat{L}_x \\pm i \\hat{L}_y.\n$$\n\nThese operators act on the eigenstates $\\lvert \\ell, m \\rangle$ (in Dirac notation, see [below](#sec-Diracangmom)) of $\\hat{L}^2$ and $\\hat{L}_z$ in the following way:\n\n$$\n\\hat{L}_\\pm \\lvert \\ell, m \\rangle \n= \\hbar \\sqrt{\\ell(\\ell+1) - m(m \\pm 1)} \\, \\lvert \\ell, m \\pm 1 \\rangle.\n$$\n\n(For mathematical proof see [appendix](#sec-ladderproof)) <!-- or [appendix @sec-ladderproof]) -->\n\n---\n\n## 5.1 Key observations\n\n- $\\hat{L}_+$ raises $m$ by one unit:  \n  $\\; m \\mapsto m+1$.\n\n- $\\hat{L}_-$ lowers $m$ by one unit:  \n  $\\; m \\mapsto m-1$.\n\n- Since the maximum value of $m$ is $\\ell$, applying $\\hat{L}_+$ to $\\lvert \\ell, \\ell \\rangle$ gives zero:  \n\n  $$\n  \\hat{L}_+ \\lvert \\ell, \\ell \\rangle = 0.\n  $$\n\n- Similarly, $L_-$ annihilates the lowest state $\\lvert \\ell, -\\ell \\rangle$:  \n\n  $$\n  \\hat{L}_- \\lvert \\ell, -\\ell \\rangle = 0.\n  $$\n\n- The ladder operators explain why the possible $m$ values for a fixed $\\ell$ are restricted to integers in the range $-\\ell, -\\ell+1, \\dots, \\ell - 1, \\ell$:\n\n  - Starting from the top state $\\lvert \\ell, \\ell \\rangle$, repeated applications of $\\hat{L}_-$ generate all the states down to $\\lvert \\ell, -\\ell \\rangle$.  \n  - No other values of $m$ appear, because outside this range the ladder action vanishes.\n\n---\n\n## 5.2 Connection to spherical harmonics\n\nIn the coordinate-space representation, these ladder operators correspond to differential operators acting on the spherical harmonics $Y_\\ell^m(\\theta,\\varphi)$:\n\n$$\n\\hat{L}_\\pm Y_\\ell^m(\\theta,\\varphi) \n= \\hbar \\sqrt{\\ell(\\ell+1) - m(m \\pm 1)} \\, Y_\\ell^{m\\pm 1}(\\theta,\\varphi).\n$$\n\nThis provides an algebraic way to generate all spherical harmonics of a given $\\ell$ starting from the “highest-weight” function $Y_\\ell^\\ell(\\theta,\\varphi)$.\n\n---\n\n# 6. Explicit Examples\n\nFor the lowest values of $\\ell$ and $m$, the normalized spherical harmonics are:\n\n- $\\ell=0, m=0$:\n  $$\n  Y_0^0 = \\sqrt{\\frac{1}{4\\pi}}.\n  $$\n\n- $\\ell=1$:\n  $$\n  Y_1^0 = \\sqrt{\\frac{3}{4\\pi}} \\cos\\theta,\n  $$\n  $$\n  Y_1^{\\pm 1} = \\mp \\sqrt{\\frac{3}{8\\pi}} \\sin\\theta \\, e^{\\pm i\\varphi}.\n  $$\n\n- $\\ell=2$:\n  $$\n  Y_2^0 = \\sqrt{\\frac{5}{16\\pi}} (3\\cos^2\\theta - 1),\n  $$\n  $$\n  Y_2^{\\pm 1} = \\mp \\sqrt{\\frac{15}{8\\pi}} \\sin\\theta \\cos\\theta \\, e^{\\pm i\\varphi},\n  $$\n  $$\n  Y_2^{\\pm 2} = \\sqrt{\\frac{15}{32\\pi}} \\sin^2\\theta \\, e^{\\pm 2i\\varphi}.\n  $$\n\nThese functions form the familiar $s$, $p$, and $d$ orbitals in atomic physics.\n\n::: {#cell-fig-sphericalh .cell fig-format='svg' execution_count=2}\n``` {.python .cell-code}\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom mpl_toolkits.mplot3d import Axes3D\n\ndef complex_spherical_harmonics_squared(l, m, theta, phi):\n    \"\"\"\n    Calculates the absolute square of the normalized complex spherical harmonic Y_l^m(theta, phi).\n\n    Args:\n        l (int): The orbital quantum number.\n        m (int): The magnetic quantum number.\n        theta (numpy.ndarray): The polar angle (from 0 to pi).\n        phi (numpy.ndarray): The azimuthal angle (from 0 to 2*pi).\n\n    Returns:\n        numpy.ndarray: The value of |Y_l^m(theta, phi)|^2.\n    \"\"\"\n    if l == 0 and m == 0:\n        return np.full_like(theta, 1.0 / (4.0 * np.pi))\n    elif l == 1:\n        if m == 0:\n            return (3.0 / (4.0 * np.pi)) * np.cos(theta)**2\n        elif abs(m) == 1:\n            # The e^(i*phi) term squared has a magnitude of 1, so we only\n            # need to square the sine term and the prefactor.\n            return (3.0 / (8.0 * np.pi)) * np.sin(theta)**2\n    elif l == 2:\n        if m == 0:\n            return (5.0 / (16.0 * np.pi)) * (3.0 * np.cos(theta)**2 - 1.0)**2\n        elif abs(m) == 1:\n            return (15.0 / (8.0 * np.pi)) * (np.sin(theta) * np.cos(theta))**2\n        elif abs(m) == 2:\n            return (15.0 / (32.0 * np.pi)) * np.sin(theta)**4\n    else:\n        # Return zeros for any other (l,m) pairs not explicitly handled.\n        return np.zeros_like(theta)\n\n# Set up the spherical coordinate grid\ntheta_phi_samples = 100\ntheta = np.linspace(0, np.pi, theta_phi_samples)\nphi = np.linspace(0, 2 * np.pi, theta_phi_samples)\ntheta, phi = np.meshgrid(theta, phi)\n\n# Define the (l, m) pairs to be plotted, avoiding redundant plots\n# We only need to plot for m >= 0\nlm_pairs = [\n    (0, 0),\n    (1, 0), (1, 1),\n    (2, 0), (2, 1), (2, 2)\n]\n\n# Calculate the squared magnitude for all spherical harmonics and find the global maximum\nall_R_values = []\nfor l, m in lm_pairs:\n    R = complex_spherical_harmonics_squared(l, m, theta, phi)\n    all_R_values.append(R)\n\n# Find the global maximum to normalize all plots to the same scale\nR_max = max(np.max(r) for r in all_R_values)\n\n# Set up the plot with a grid of subplots (2 rows, 3 columns)\nfig = plt.figure(figsize=(7, 4.67))\n\n# Loop through the pairs and create a subplot for each\nfor i, (l, m) in enumerate(lm_pairs):\n    ax = fig.add_subplot(2, 3, i + 1, projection='3d')\n    # Set equal aspect ratio for the plot box\n    ax.set_box_aspect([1, 1, 1])\n\n    # Get the pre-calculated R and normalize it\n    R = all_R_values[i] / np.max(all_R_values[i])#R_max\n    if (l,m)==(0,0): R = R/1.5\n\n    # Convert to Cartesian coordinates for plotting\n    x = R * np.sin(theta) * np.cos(phi)\n    y = R * np.sin(theta) * np.sin(phi)\n    z = R * np.cos(theta)\n\n    # Normalize the R values for color mapping and apply alpha\n    norm = plt.Normalize(vmin=R.min(), vmax=R.max())\n    if (l,m)==(0,0): norm = plt.Normalize(vmin=R.min()-.1, vmax=R.max()+.1)\n    colors = plt.cm.jet(norm(R))\n    \n    # Plot the surface with colors based on the radius and alpha set directly\n    ax.plot_surface(x, y, z, rstride=1, cstride=1, facecolors=colors,\n                    edgecolor='none', alpha=0.8)\n    \n    # Plot the surface, with a solid, uniform color to better show shape\n#    ax.plot_surface(x, y, z, rstride=1, cstride=1, cmap='viridis',\n#                    edgecolor='none', alpha=0.8)\n    \n    \n    # Manually set the axis limits to be identical across all plots\n    ax.set_xlim([-1, 1])\n    ax.set_ylim([-1, 1])\n    ax.set_zlim([-1, 1])\n\n    # Set titles for each subplot, using the pm symbol where appropriate\n    if m == 0:\n        title = r'$|Y_{' + str(l) + '}^0|^2$'\n    else:\n        title = r'$|Y_{' + str(l) + '}^{\\pm ' + str(m) + '}|^2$'\n    ax.set_title(title, fontsize=14)\n\n    # Hide the axes to make the plot cleaner\n    ax.set_axis_off()\n\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Absolute square of some spherical harmonics in 3D polar plot.](angmom_files/figure-html/fig-sphericalh-output-1.png){#fig-sphericalh width=635 height=439 fig-alt='Absolute square of some spherical harmonics in 3D polar plot.'}\n:::\n:::\n\n\n---\n\n# 7. Dirac notation {#sec-Diracangmom}\n\nIn **Dirac notation**, we can label the angular momentum eigenstates as $\\lvert \\ell, m \\rangle$.  \n\nThis reminds us that the spherical harmonics $Y_\\ell^m(\\theta,\\varphi)$ are simply the coordinate-space representation of the abstract states $\\lvert \\ell, m \\rangle$:\n\n$$\nY_\\ell^m(\\theta,\\varphi) = \\langle \\theta, \\varphi \\,|\\, \\ell, m \\rangle.\n$$\n\nHence, the two notations are fully consistent:  \n- The **wavefunction view** uses functions on the sphere $Y_\\ell^m(\\theta,\\varphi)$.  \n- The **operator view** uses abstract eigenstates $\\lvert \\ell, m \\rangle$. \n\n\n::: {.callout-tip}\n## Important\n\nThe orthonormality relation then reads:\n\n$$\n\\langle \\ell, m \\,|\\, \\ell', m' \\rangle = \\delta_{\\ell\\ell'} \\, \\delta_{mm'}.\n$$\n\nThe eigenvalue equations are:\n\n\n$$\n\\boxed{\\;\n\\hat{L}^2 \\lvert \\ell, m \\rangle = \\hbar^2 \\ell(\\ell+1) \\lvert \\ell, m \\rangle, \\qquad\n\\hat{L}_z \\lvert \\ell, m \\rangle = \\hbar m \\lvert \\ell, m \\rangle\n\\;}\n$$\n\nwith the quantum numbers\n\n$$\n\\ell = 0, 1, 2, \\dots, \\qquad m = -\\ell, -\\ell+1, \\dots, \\ell-1, \\ell.\n$$\n\n:::\n\n---\n\n# Appendix: Proof of the Ladder Operator Action {#sec-ladderproof}\n\nTo justify the standard formulas for the action of the ladder operators on angular momentum eigenstates, let us derive them step by step.\n\n---\n\n## Step 1: Definitions and commutators\n\nDefine the ladder operators\n$$\n\\hat L_\\pm = \\hat L_x \\pm i \\hat L_y.\n$$\n\nThey satisfy the commutation relations\n$$\n[\\hat L_z, \\hat L_\\pm] = \\pm \\hbar \\hat L_\\pm, \n\\qquad\n[\\hat L_+, \\hat L_-] = 2\\hbar \\hat L_z.\n$$\n\nThus, if $\\hat L_z \\lvert \\ell,m \\rangle = \\hbar m \\lvert \\ell,m \\rangle$, then\n$$\n\\hat L_z(\\hat L_\\pm \\lvert \\ell,m \\rangle) \n= (\\hbar m \\pm \\hbar)\\, \\hat L_\\pm \\lvert \\ell,m \\rangle.\n$$\n\n::: {.callout-note collapse=\"true\"}\n## Proof\n\nThe commutator of $\\hat L_z$ with the ladder operators is\n\n$$\n[\\hat L_z, \\hat L_\\pm] \n= [\\hat L_z, \\hat L_x] \\pm i [\\hat L_z, \\hat L_y] \n= i \\hbar \\hat L_y \\pm \\hbar \\hat L_x \n= \\pm \\hbar (\\hat L_x \\pm i \\hat L_y) \n= \\pm \\hbar \\hat L_\\pm .\n$$\n\nFrom this relation we obtain the operator identity\n\n$$\n\\hat L_z \\hat L_\\pm \n= [\\hat L_z, \\hat L_\\pm] + \\hat L_\\pm \\hat L_z \n= \\pm \\hbar \\hat L_\\pm + \\hat L_\\pm \\hat L_z \n= \\hat L_\\pm(\\hat L_z \\pm \\hbar).\n$$\n\nThus, when acting on an eigenstate $\\lvert \\ell, m \\rangle$ of $\\hat L^2$ and $\\hat L_z$, the operator $\\hat L_\\pm$ shifts the magnetic quantum number by one unit:\n\n$$\n\\hat L_z \\, (\\hat L_\\pm \\lvert \\ell, m \\rangle) \n= (m \\pm 1)\\hbar \\, (\\hat L_\\pm \\lvert \\ell, m \\rangle).\n$$\n\n\n:::\n\n\nThis shows that $\\hat L_\\pm$ (if nonzero) produces another eigenstate with eigenvalue $m \\pm 1$.  \nSo we may write\n$$\n\\hat L_\\pm \\lvert \\ell,m \\rangle = C_\\pm(\\ell,m) \\lvert \\ell, m \\pm 1 \\rangle,\n$$\nfor some coefficient $C_\\pm(\\ell,m)$.\n\n---\n\n## Step 2: Determining $|C_\\pm|^2$\n\nConsider the squared norm:\n$$\n\\|\\hat L_+ \\lvert \\ell,m \\rangle \\|^2 \n= \\langle \\ell,m | \\hat L_- \\hat L_+ | \\ell,m \\rangle.\n$$\n\nUsing the operator identity\n$$\n\\hat L_- \\hat L_+ = \\hat L^2 - \\hat L_z^2 - \\hbar \\hat L_z,\n$$\nand the eigenvalue equations\n$$\n\\hat L^2 \\lvert \\ell,m \\rangle = \\hbar^2 \\ell(\\ell+1) \\lvert \\ell,m \\rangle, \n\\qquad\n\\hat L_z \\lvert \\ell,m \\rangle = \\hbar m \\lvert \\ell,m \\rangle,\n$$\nwe get\n$$\n\\|\\hat L_+ \\lvert \\ell,m \\rangle \\|^2\n= \\hbar^2 \\big(\\ell(\\ell+1) - m(m+1)\\big).\n$$\n\nThus,\n$$\n|C_+(\\ell,m)|^2 = \\hbar^2 \\big(\\ell(\\ell+1) - m(m+1)\\big).\n$$\n\nSimilarly, using\n$$\n\\hat L_+ \\hat L_- = \\hat L^2 - \\hat L_z^2 + \\hbar \\hat L_z,\n$$\nwe find\n$$\n|C_-(\\ell,m)|^2 = \\hbar^2 \\big(\\ell(\\ell+1) - m(m-1)\\big).\n$$\n\n---\n\n## Step 3: Fixing the phase convention\n\nWe can choose the overall phase of the eigenstates such that $C_\\pm$ are real and positive. With this standard convention we obtain:\n\n$$\n\\hat L_+ \\lvert \\ell,m \\rangle \n= \\hbar \\sqrt{\\ell(\\ell+1) - m(m+1)} \\; \\lvert \\ell,m+1 \\rangle,\n$$\n\n$$\n\\hat L_- \\lvert \\ell,m \\rangle \n= \\hbar \\sqrt{\\ell(\\ell+1) - m(m-1)} \\; \\lvert \\ell,m-1 \\rangle.\n$$\n\n---\n\n**Conclusion:**  \nThe ladder operators raise or lower the $m$ quantum number by one unit, with the above coefficients.\n\n",
    "supporting": [
      "angmom_files"
    ],
    "filters": [],
    "includes": {}
  }
}